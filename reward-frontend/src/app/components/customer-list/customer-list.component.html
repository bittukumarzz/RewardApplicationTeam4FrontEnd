<div class="container mt-5">
  
    <h2 class="mb-4">Search Customer</h2>
  
    <div class="card p-4 bg-light shadow-sm mb-4">
      <div class="row g-3">
        
        <div class="col-md-5">
          <label class="form-label fw-bold">Search by Name</label>
          <input type="text" class="form-control" placeholder="e.g. John" 
                 [(ngModel)]="searchName" (keyup)="onSearch()">
        </div>
  
        <div class="col-md-5">
          <label class="form-label fw-bold">Search by Card Number</label>
          <input type="text" class="form-control" placeholder="e.g. 5678" 
                 [(ngModel)]="searchCard" (keyup)="onSearch()">
        </div>
  
        <div class="col-md-2 d-flex align-items-end">
          <button class="btn btn-outline-secondary w-100" (click)="loadCustomers()">
            ↻ Refresh
          </button>
        </div>

        <div class="col-md-2 d-flex align-items-end">
          <button class="btn btn-success w-100" routerLink="/add-customer">
            + New Customer
          </button>
       </div>
  
      </div>
    </div>
  
    <div *ngIf="isLoading" class="text-center my-4">
      <div class="spinner-border text-primary" role="status"></div>
      <p>Loading customers...</p>
    </div>
    
    <div *ngIf="errorMsg" class="alert alert-danger">{{ errorMsg }}</div>
  
    <div class="table-responsive" *ngIf="!isLoading">
      <table class="table table-hover table-bordered align-middle bg-white shadow-sm">
        <thead class="table-dark">
          <tr>
            <th>ID</th>
            <th>Name</th>
            <th>Email</th>
            <th>Phone</th>
            <th>Card Number</th>
            <th class="text-center">Action</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let cust of filteredCustomers">
            <td>{{ cust.customerId }}</td>
            
            <td class="fw-bold">{{ cust.firstName }} {{ cust.lastName }}</td>
            
            <td>{{ cust.email }}</td>
            <td>{{ cust.phoneNum }}</td>
            
            <td>
                <span *ngIf="cust.creditCard && cust.creditCard.length > 0">
                  {{ cust.creditCard[0].cardNumber }}
                </span>
                <span *ngIf="!cust.creditCard || cust.creditCard.length === 0" class="text-muted fst-italic">
                  No Card
                </span>
              </td>
            
            <td class="text-center">
              <button class="btn btn-sm btn-primary px-3" (click)="viewCustomer(cust.customerId)">
                Select ➜
              </button>
            </td>
          </tr>
          
          <tr *ngIf="filteredCustomers.length === 0">
            <td colspan="6" class="text-center py-4 text-muted">
              No customers found matching your search.
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>