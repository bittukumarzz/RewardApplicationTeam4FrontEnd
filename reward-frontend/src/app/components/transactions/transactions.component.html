<div class="container mt-4">
  
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h2>Transaction Management</h2>
    <span class="badge bg-secondary p-2">
      Customer ID: {{ transactions[0]?.creditCard?.customer?.customerId || 'Unknown' }}
    </span>
  </div>

  <div class="card p-3 mb-4 bg-light shadow-sm">
    <div class="d-flex gap-2">
      <button class="btn btn-primary" (click)="loadTransactions()" [disabled]="isLoading">
        <span *ngIf="isLoading" class="spinner-border spinner-border-sm me-1"></span>
        {{ isLoading ? 'Loading...' : '1. Load Mock Transactions' }}
      </button>

      <button class="btn btn-success" (click)="processAll()" 
              [disabled]="pendingCount === 0 || isLoading">
        2. Process All Pending ({{ pendingCount }})
      </button>
    </div>
  </div>

  <div *ngIf="message" class="alert alert-success alert-dismissible fade show">
    {{ message }}
    <button type="button" class="btn-close" (click)="message=''"></button>
  </div>
  <div *ngIf="errorMsg" class="alert alert-danger">{{ errorMsg }}</div>

  <div class="table-responsive">
    <table class="table table-hover table-bordered align-middle">
      <thead class="table-dark">
        <tr>
          <th>ID</th>
          <th>Card #</th>
          <th>Item</th>
          <th>Date</th>
          <th class="text-end">Amount</th>
          <th class="text-center">Status</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let txn of transactions" [class.table-success]="txn.status === 'PROCESSED'">
          <td>{{ txn.transactionId }}</td>
          <td>{{ txn.creditCard?.cardNumber || 'N/A' }}</td>
          <td>{{ txn.item }}</td>
          <td>{{ txn.transactionDate | date:'medium' }}</td>
          <td class="text-end fw-bold">{{ txn.amount | currency:'INR' }}</td>
          <td class="text-center">
            <span [class]="txn.status === 'PENDING' ? 'badge bg-warning text-dark' : 'badge bg-success'">
              {{ txn.status }}
            </span>
          </td>
        </tr>
        <tr *ngIf="transactions.length === 0">
          <td colspan="6" class="text-center text-muted py-4">
            No transactions found. Click "Load Mock Transactions".
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>